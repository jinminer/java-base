# 类和接口

## 使类和成员的可访问性最小化

* 应该尽可能地减少程序元素的可访问性（在合理范围内）。
*  在仔细设计一个最小化的公共 `API` 之后，应该防止任何散乱的类，接口或成员成为 API 的一部分。 
* 除了作为常量的公共静态 final 属性之外，公共类不应该有公共属性。 
* 确保 `public static final` 属性引用的对象是不可变的。



## 在公共类中使用访问方法而不是公共属性

* 公共类不应该暴露可变属性。 
* 公共累暴露不可变属性的危害虽然仍然存在问题，但其危害较小。
* 有时需要包级私有或私有内部类来暴露属性，无论此类是否是可变的。



## 最小化可变性

* 要使一个类不可变，请遵循以下五条规则：
  * 不要提供修改对象状态的方法（也称为 mutators）。
  * 确保这个类不能被继承。 这可以防止粗心的或恶意的子类，假设对象的状态已经改变，从而破坏类的不可变行为。 防止子类化通常是通过 final 修饰类，但是我们稍后将讨论另一种方法。
  * 把所有属性设置为 final。 通过系统强制执行，清楚地表达了你的意图。 另外，如果一个新创建的实例的引用从一个线程传递到另一个线程而没有同步，就必须保证正确的行为，正如内存模型所述。
  * 把所有的属性设置为 private。 这可以防止客户端获得对属性引用的可变对象的访问权限并直接修改这些对象。 虽然技术上允许不可变类具有包含基本类型数值的公共 final 属性或对不可变对象的引用，但不建议这样做，因为它不允许在以后的版本中更改内部表示。
  * 确保对任何可变组件的互斥访问。 如果你的类有任何引用可变对象的属性，请确保该类的客户端无法获得对这些对象的引用。 切勿将这样的属性初始化为客户端提供的对象引用，或从访问方法返回属性。 在构造方法，访问方法和 `readObject` 方法中进行防御性拷贝。



## 组合优于继承

* 如果子类与父类不在同一个包中，并且父类不是为继承而设计的，继承可能会导致脆弱性。
* 为了避免这种脆弱性，使用合成和转发代替继承，特别是如果存在一个合适的接口来实现包装类。 
* 包装类不仅比子类更健壮，而且更强大。



## 要么设计继承并提供文档说明，要么禁用继承



## 接口优于抽象类



## 为后代设计接口



## 接口仅用来定义类型



## 类层次结构优于标签类



## 支持使用静态成员类而不是非静态类



## 将源文件限制为单个顶级类

























